<!DOCTYPE html>
<html lang="he" dir="rtl">
  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">

    
    <meta itemprop="name" content="עוברים דירה | בלוג פשוט">
    <meta itemprop="description" content="צר עולמי כ  U+200A">

    
    <meta name="twitter:title" content="עוברים דירה | בלוג פשוט">
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:description" content="צר עולמי כ  U+200A">
    <meta name="twitter:site" content="@yehudab">
    <meta name="twitter:creator" content="@yehudab">
    <meta name="twitter:image:src" content="https://yehudab.com/img/2020/Docker.PNG">

    
    <meta name="og:title" content="עוברים דירה | בלוג פשוט">
    <meta name="og:description" content="צר עולמי כ  U+200A">
    <meta name="og:image" content="https://yehudab.com/img/2020/Docker.PNG">
    <meta name="og:url" content="https://yehudab.com/">
    <meta name="og:site_name" content="בלוג פשוט">
    <meta name="og:locale" content="en_GB">
    <meta name="og:type" content="website">

    <link rel="icon" type="image/x-icon" href="/favicon.ico"/>

    <title>
      עוברים דירה
      
       | בלוג פשוט</title>

    <link rel="stylesheet" href="/assets/main.bundle.css">

    
  </head>
  <body class="flex flex-col min-h-screen">
    <header>
  <nav class="container mx-auto max-w-3xl px-8 pt-2 flex flex-wrap justify-between">
    <div>
      <h1>
        <a href="/">בלוג פשוט</a>
      </h1>
      <p>צר עולמי כ  U+200A</p>
    </div>

    <ul class="flex flex-wrap sm:w-32 w-full mt-6 md:justify-between justify-evenly">
      <li>
        <a href="/blog/about">אודות</a>
      </li>
    </ul>
  </nav>
</header>
    <main class="container mx-auto max-w-3xl p-8 flex-grow">
      
    <p></p>
    <div>
        <h2>עוברים דירה</h2>

        

        
            <div class="mb-2">
                <a class="tag Docker" href="/tag/Docker">Docker</a><a class="tag Hosting" href="/tag/Hosting">Hosting</a><a class="tag וורדפרס" href="/tag/וורדפרס">וורדפרס</a><a class="tag לינוקס" href="/tag/לינוקס">לינוקס</a><a class="tag קוד פתוח ותוכנה חופשית" href="/tag/קוד פתוח ותוכנה חופשית">קוד פתוח ותוכנה חופשית</a>
            </div>
        

        
            <p class="text-sm italic">נכתב ב<span datetime="Sat Jul 18 2020 12:06:54 GMT+0000 (Coordinated Universal Time)">18 ביולי 2020</span>.</p>
        

        <div class="content post">
            <p><img src="/img/2020/Docker.PNG" alt="Docker">
אחרי שלוש שנים שבהן <a href="https://yehudab.com/blog/2017/06/yet-another-blog-upgrade/">האתר הזה רץ מעל שרות האחסון של Scaleway</a>, קיבלתי מהם הודעה שהחומרה שעליה אני רץ (dual core ARM CPU, 2GB RAM, 50GB SSD) תפסיק לעבוד בעוד מספר חודשים. הם הציעו לי לעבור באותו מחיר לשרת VPS מבוסס אינטל, אלא שעוד לפני שהספקתי להגיב, קיבלתי את המכתב שזו כותרתו: We’re evolving our Instances prices, או בתרגום חופשי: נמאס לנו להיות הכי זולים בשוק, אז נעלה את המחיר ב 66%.</p>
<p>החלטתי שזה הזמן לחפש שרות אכסון חדש, והגעתי דרך חבר לעבודה ל <a href="https://www.ovh.ie/">OVHcloud</a>. השרת הבסיסי נראה על הנייר חלש יותר (מעבד אחד בלבד ודיסק קטן יותר), אבל בבדיקות ביצועים בשטח הוא משמעותית יותר מהיר. זה מורגש גם בעבודת ההתקנה (פרטים בהמשך) וגם בזמן ריצה, כפי שנמדד ע״י StatusCake. המחיר זהה למחיר (הישן) של Scaleway: שלושה אירו לחודש, בלי התחייבות.</p>
<p>השרת שלי מריץ בנוסף גם שני שרתי node קטנים, כך שהעברת כל הטוב הזה היא לא פשוטה, ולכן החלטתי הפעם ללכת על Docker. למי שלא מכיר את Docker, מומלץ לקרוא את סדרת המאמרים באתר של רן בר-זיק. שם הוא גם <a href="https://internet-israel.com/%D7%9E%D7%93%D7%A8%D7%99%D7%9B%D7%99%D7%9D/docker/%D7%95%D7%95%D7%A8%D7%93%D7%A4%D7%A8%D7%A1-%D7%A2%D7%9C-docker/">מדגים התקנת WordPress</a>. אני בחרתי לעקוב אחרי <a href="https://github.com/mjstealey/wordpress-nginx-docker">המדריך של Michael J. Stealey</a> ב GitHub, שממנו גם עשיתי פורק לריפו משלי. המדריך הזה קצת יותר מתאים לסביבה הנוכחית שלי שכוללת MariaDB במקום MySQL, וגם סקריפטים מוכנים לתמיכה ב https, דרך השרות של <a href="https://letsencrypt.org/">Let’s Encrypt</a>.</p>
<p>רוב התהליך עוקב אחרי ה README, אבל מכוון שלא התחלתי מאתר חדש כפי שהמדריך מתאר, ביצעתי מספר שינויים, כמו שיחזור של ה DB ומבנה הקבצים מהשרת הנוכחי. זו הייתה טבילת האש הראשונה ל restic שהזכרתי <a href="https://yehudab.com/blog/2020/03/php-7-4/">באחד הפוסטים הקודמים</a> והוא הוכיח את עצמו מצויין. שחזור של MySQL שרץ בתוך קונייטנר הוא קצת מורכב, וגם כאן <a href="https://internet-israel.com/%D7%9E%D7%93%D7%A8%D7%99%D7%9B%D7%99%D7%9D/docker/%D7%93%D7%95%D7%A7%D7%A8-%D7%9B%D7%A0%D7%99%D7%A1%D7%94-%D7%9C%D7%AA%D7%95%D7%9A-%D7%A7%D7%95%D7%A0%D7%98%D7%99%D7%99%D7%A0%D7%A8-%D7%95%D7%A4%D7%A2%D7%95%D7%9C%D7%95%D7%AA-%D7%91%D7%AA%D7%95%D7%9B/">יש לבר-זיק מדריך טוב</a>.</p>
<p>אז נשארו לי כמה קצוות לסגור, כמו חידוש אוטומטי של הסרטיפיקטים ב Let’s Encrypt, והפעלה של גיבויים, אבל בסך הכל נראה שדוקר עושה עבודה טובה, והמעבר הבא יצריך ״רק״:</p>
<pre class="language-bash"><code class="language-bash"><span class="token function">sudo</span> docker-compose up -d</code></pre>

        </div>

<div class="comments">
    

    
        <div id="respond" class="comment-new">
            <form class="comments-form js-form" method="post" action="https://staticman.yehudab.com/v2/entry/yehudab/11r/master/comments">
  <div class="clearfix">
    <h2>כתיבת תגובה</h2>
    <a class="cancel-comment" href="#">ביטול</a>
  </div>
  <span>האימייל לא יוצג באתר. שדות החובה מסומנים *</span>
  <input type="hidden" id="comment-replying-to-id" name="fields[parentId]" value="">
  <input type="hidden" name="options[slug]" value="docker">
  <input type="hidden" name="options[reCaptcha][siteKey]" value="6LfnPtEZAAAAAOjThTjcNoPS37UePCEC7AGYLhOM">
  <input type="hidden" name="options[reCaptcha][secret]"  value="CwzOWWGyNqgtCUE5MQs9kHdkNXc2wAsLZiuAXB04ibhAjxE84pI6su8YfEfhln0qCXQ/DJHnKq57Wozmd9X2Xhx0NGRwrqnh9oAqqH+9Y0Av94sPRNYQQh/Y/vr+jQGaM82maK5eWXPNfQ6Xylk3Z/6d/URvGRmbB3cmPnFMJebsjAyQLH2PJPiwV6HjwPRVNsJBJedOg8fZ4Bs5GQa53qrQw3qX7De/nGfmiwbLa+VcY0rTTkTkpsa/QsnamYJoCgiyJG+2MXnlhMVOyQEQyU1L9ZRMb14SAi5ZvFP0MbT2EOJbt/CSKwKNWQrqkfwWSc0xP3jgecG2Tt6BrewRe7IDYYdYadWAzy3hkbqIz9VmYF0stnSo6gsZg3JH1+YUGnWtdLb4//5hl4ETD0Yw88C4w4ddXmoznmkzSyU+yj4UMXGAaRr+VpFwynqJwEwWK19SDIOUXgwScM3HIDiIaLh4PTduY+mSaNx8NyHes9/7yMMPAYYNlot7RzHNaNyTbCLaXjZlSy3QxKIwHrFEI0CRYwO/DMVD+KpKVE/ma3ANuFSP11HERyOgTFuj3xtlJQw5UQnniawvRvVAIlXqBdVRjdX/mHgmJajFbimC4VFqg590rO1YGJo0ej1R43XSe6l0QXqW7AVDkAPl5HZd3cvpSsEVBW01TJcDbYq5yGM=">
  

  <div class="form-line">
    <div class="field-full-line">
      <label for="comment-form-message">
      התגובה שלך *
        <textarea name="fields[message]" type="text" id="comment-form-message" required rows="6"></textarea>
      </label>
    </div>
  </div>

  <div class="form-line">
    <div class="field-half-line md:w-1/2 mb-6 md:mb-0">
      <label for="comment-form-name">
      שם *
        <input name="fields[name]" type="text" id="comment-form-name" placeholder="" required/>
      </label>
    </div>

    <div class="field-half-line md:w-1/2">
      <label for="comment-form-email">
      E-mail *
        <input name="fields[email]" type="email" id="comment-form-email" placeholder="" required/>
      </label>
    </div>
  </div>

  <div class="form-line">
    <div class="field-full-line">
      <label for="hp">
      אתר
        <input name="fields[url]" id="url" type="text">
      </label>
    </div>
  </div>

  <div id="reCaptcha" class="g-recaptcha" data-sitekey="6LfnPtEZAAAAAOjThTjcNoPS37UePCEC7AGYLhOM"></div>

  <button id="comment-form-submit">
      שליחה
  </button>

</form>
<svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" style="display:none" >
  <symbol id="icon-loading" viewBox="149.8 37.8 499.818 525"><path d="M557.8 187.8c13.8 0 24.601-10.8 24.601-24.6S571.6 138.6 557.8 138.6s-24.6 10.8-24.6 24.6c0 13.2 10.8 24.6 24.6 24.6zm61.2 90.6c-16.8 0-30.6 13.8-30.6 30.6s13.8 30.6 30.6 30.6 30.6-13.8 30.6-30.6c.6-16.8-13.2-30.6-30.6-30.6zm-61.2 145.2c-20.399 0-36.6 16.2-36.6 36.601 0 20.399 16.2 36.6 36.6 36.6 20.4 0 36.601-16.2 36.601-36.6C595 439.8 578.2 423.6 557.8 423.6zM409 476.4c-24 0-43.2 19.199-43.2 43.199s19.2 43.2 43.2 43.2 43.2-19.2 43.2-43.2S433 476.4 409 476.4zM260.8 411c-27 0-49.2 22.2-49.2 49.2s22.2 49.2 49.2 49.2 49.2-22.2 49.2-49.2-22.2-49.2-49.2-49.2zm-10.2-102c0-27.6-22.8-50.4-50.4-50.4-27.6 0-50.4 22.8-50.4 50.4 0 27.6 22.8 50.4 50.4 50.4 27.6 0 50.4-22.2 50.4-50.4zm10.2-199.8c-30 0-54 24-54 54s24 54 54 54 54-24 54-54-24.6-54-54-54zM409 37.8c-35.4 0-63.6 28.8-63.6 63.6S374.2 165 409 165s63.6-28.8 63.6-63.6-28.2-63.6-63.6-63.6z"/>
  </symbol>
</svg>
        </div>
    
</div>
            <p class="uppercase text-xs mt-6">הבא</p>
            <p class="font-bold mb-2">
                <a href="/blog/2020/07/11ty/">11ty</a>
            </p>
        
            <p class="uppercase text-xs mt-6">הקודם</p>

            <p class="font-bold">
                <a href="/blog/2020/03/php-7-4/">php 7.4</a>
            </p>
        
    </div>

    </main>
    <footer class="bg-gray-900 pb-10">
  <p class="block text-center text-sm mb-6">
    CC-BY-SA
    <a href="/">
      Yehuda Bar Nir
    </a>
    &bull; Built with <a href="https://www.11ty.dev/">11ty</a> 
    &bull; Based on <a target="_blank" href="https://github.com/reeseschultz/11r">11r</a> by
    <a target="_blank" href="https://reeseschultz.com">
      Reese Schultz
    </a> 
  </p>

</footer>
    
    <script src="/assets/lib/cash.js"></script>
    <script src="/assets/main.bundle.js"></script>
    <script src="https://www.google.com/recaptcha/api.js" async defer></script>
    <script async src="https://ackee.yehudab.com/blog-utils.js" data-ackee-server="https://ackee.yehudab.com" data-ackee-domain-id="9c5f49e5-e4a2-44dd-99bf-9f38e447246c"></script>
  </body>
</html>