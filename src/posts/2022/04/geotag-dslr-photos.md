---
date: '2022-04-23T08:37:27Z'
status: publish
author: יהודה
type: post
title: תיוג מיקום במצלמת DSLR
path: geotag-dslr-photos
excerpt: 'אחרי שנים רבות של צילום במצלמת הטלפון בלבד, החלטתי לחזור למקורות ולקנות מצלמה דיגיטלית ״אמיתית״. בחרתי בדגם כניסה של Canon, וצימדתי לו עדשת פריים טובה, ועוד כמה עדשות זום סבירות.'
ogImage: 'img/2022/04/photo-in-gaig-gps-after-geo-tagging.png'
tags:
- Geotagging
- קוד פתוח ותוכנה חופשית

---
אחרי שנים רבות של צילום במצלמת הטלפון בלבד, החלטתי לחזור למקורות ולקנות מצלמה דיגיטלית ״אמיתית״. בחרתי [בדגם כניסה של Canon](https://www.dpreview.com/products/canon/slrs/canon_eos2000d "Canon EOS 2000D"), וצימדתי לו [עדשת פריים טובה](https://www.dpreview.com/products/canon/lenses/canon_50_1p8_stm "Canon EF 50mm F1.8 STM"), ועוד כמה עדשות זום סבירות.

את הבסיס לשימוש במצלמה למדתי דרך כמה [ערוצים](https://www.youtube.com/user/JaredPolin "Jared Polin") [פופלריים](https://www.youtube.com/channel/UC9lyUdwosxq_OxC1uggjUPA "Photo Genius") ב youtube והשאר מניסיון. מה שבעיקר היה חסר לי בצילום במצלמה הזאת (וכנראה נכון למספר גדול מאוד של דגמים, כולל יקרים הרבה יותר) הוא חוסר היכולת לתייג בקלות את מיקום התמונות. זה פחות מפריע אם מצלמים בארוע במקום ידוע, ויותר בעייתי כאשר מצלמים בטיולים.

לחלק מהדגמים אפשר [לצמד GPS חיצוני](https://www.bhphotovideo.com/c/product/847538-REG/Canon_6363B001_GPS_Receiver_GP_E2.html "Canon GPS Receiver GP-E2"). דגמים אחרים מאפשרים לתייג תוך כדי צילום ע״י אפליקציה שרצה במקביל על הטלפון, אבל זה מחייב הפעלת Wi-Fi על שני המכשירים וגוזלת אחוזי סוללה נכבדים תוך כדי שימוש. בכל מקרה, למצלמה שלי לא ניתן לחבר את המכשיר החיצוני, וגם דרך האפליקציה הרשמית של קנון לא הצלחתי לתייג תוך כדי תנועה. יותר מזה, כאשר הטלפון מחובר ל Wi-Fi של המצלמה, אין אפשרות להתחבר במקביל לאינטרנט.

כדי לפתור את הבעיה, פיתחתי תהליך עבודה פשוט (יחסית...). התהליך כולל שלושה שלבים:

1. הקלטת מסלול ההליכה. את זה אני בדרך-כלל עושה ממילא כדי לדעת נתונים כמו מרחק וקצב ההליכה, כמות עליות וירידות, ולפעמים כדי למצוא את הרכב בסוף המסלול. אני משתמש באפליקציה החינמית [Gaia GPS](https://www.gaiagps.com), אבל כל אפליקציה שיודעת ליצא קבצי GPX של המסלול תעשה את העבודה. במקרה של האפליקציה הזאת, ההקלטה גם נשמרת בענן, ואפשר בקלות להוריד אותה למחשב דרך האתר שלהם:

   ![](/img/2022/04/gaia-gps-export-to-gpx.png)
2. סינכרון הזמנים בין שעון המצלמה לשעון הטלפון. לכל צורך מעשי, מספיק לעדכן פעם בשבוע-שבועיים את שעון המצלמה. מצד שני, לכל צורך מעשי כנראה מספיק לצלם בטלפון, אז לא בשביל זה באנו לכאן... מה שאני עושה הוא לצלם במצלמת ה DSLR קוד QR שמוצג על הטלפון ומתחלף כל שניה ומכיל את התאריך והשעה המדוייקים. הצילום מכיל כמטא-דתה את השעה בשעון המצלמה, וה QR מקודד את השעה המדוייקת וכך ניתן לדעת מה ההפרש. הייתי בטוח שיש המון אפליקציות שמציגות את השעה ב-QR-ית, אבל לא מצאתי. מה שכן מצאתי הוא [אפליקציית ווב בקוד פתוח](https://github.com/kaelhem/qr-clock "QR clock by kaelhem"), אבל היא הציגה את התאריך בפורמט לא נח לפרסור, אז [מיזלגתי אותה](https://github.com/yehudab/qr-clock "QR clock GitHub repo") והעלתי עותק פרטי [לאתר שלי](https://apps.yehudab.com/qr-clock/ "QR Clock"). ככה נראה צילום כזה:

   ![](/img/2022/04/qr-clock.jpg)
3. הורדת קבצי ההליכה והתמונות (כולל תמונת ה QR) למחשב והפעלת סקריפט שמתייג את המיקום תוך כדי ההתחשבות בהפרש הזמנים. לשם כך אני משתמש בשתי תוכנות בקוד פתוח: [zbar](https://github.com/mchehab/zbar "zbar GitHub repo") שיודעת לחלץ את השעה מקוד ה QR, ו-[ExifTool](https://exiftool.org) שיודעת לחלץ את שעת הצילום מתמונת שעון ה-QR  ולתייג מיקום ע״פ קובץ GPX והפרש זמנים. את הסקריפט עצמו (גרסה למק, יתכן שלא יעבוד as-is בלינוקס) אפשר למצוא ב [GitHub שלי](https://github.com/yehudab/things/blob/main/geotag.sh "geotag.sh in GitHub").

   בהנחה שהקלטת המסלול נשמרה בקובץ: track.pgx, תמונת שעון ה QR נשמרה בקובץ qr.jpeg, וכל התמונות מהמסלול הזה נשמרו בתיקיה הנוכחית, הפעלת הסקירפט נעשית ע״י שורה אחת:

```bash
geotag.sh qr.jpeg track.gpx
```

עכשיו נוכל לראות את התמונות בדיוק במקום שבו הן צולמו:

![](/img/2022/04/photo-in-gaig-gps-after-geo-tagging.png)
